<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mapa Polski ok. 1650 r. – interaktywna + konsola rysunku</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Dzieje Rzeczypospolitej szlacheckiej</h1>
    </div>
  </header>

  <main>
    <div class="layout">
      <aside class="sidebar" aria-label="Menu boczne">
        <div class="head"><h2>Panel dowodzenia</h2></div>

        <!-- Marszałek -->
        <div class="section" aria-label="Marszałek">
          <div class="marshal-row">
            <span class="marshal-label">Marszałek:</span>
            <div id="marshalBox" class="marshal-box" role="img" aria-label="Kolor Marszałka"></div>
            <button id="marshalResetBtn" class="marshal-reset" type="button">Wyczyść</button>
          </div>
        </div>

        <div class="section" aria-label="Tabela Graczy">
          <h2 style="font-size:1rem;margin:0 0 10px;color:#cbd5e1">Gracze</h2>
          <table class="players-table" id="playersTable" aria-describedby="players-desc">
            <caption id="players-desc" style="clip:rect(0 0 0 0);position:absolute">
              Tabela graczy z kolorem, liczbą złota, punktami honoru i punktami końcowymi
            </caption>
            <thead>
              <tr>
                <th style="width:36px" aria-label="Kolor"></th>
                <th style="text-align:left">Imię</th>
                <th>Złoto</th>
                <th>Honor</th>
                <th>Punkty</th>
              </tr>
            </thead>
            <tbody id="playersBody"></tbody>
          </table>
        </div>

        <!-- Szlachcice -->
        <div class="section" aria-label="Tabela Szlachciców">
          <h2 style="font-size:1rem;margin:0 0 10px;color:#cbd5e1">Szlachcice</h2>
          <table class="nobles-table" id="noblesTable" aria-describedby="nobles-desc">
            <caption id="nobles-desc" style="clip:rect(0 0 0 0);position:absolute">Tabela 4 slotów dla każdej prowincji</caption>
            <thead></thead>
            <tbody id="noblesBody"></tbody>
          </table>
        </div>
      </aside>

      <section class="map-card" aria-describedby="map-desc">
        <div class="map-header">
          <div class="actions">
            <div class="round">
              <div id="turnBadge" class="turn-badge" aria-live="polite">
                <span class="label">TURA:</span>
                <span id="turnSwatch" class="swatch" aria-hidden="true"></span>
                <span id="turnName" class="name">–</span>
              </div>
              
              <span id="roundLabel">
                RUNDA <strong id="roundCur">1</strong>/<span id="roundMax">10</span>
              </span>
            </div>
          </div>
        </div>

        <!-- Pasek faz gry -->
        <nav class="phasebar" id="phaseBar" aria-label="Fazy gry"></nav>

        <div class="svg-wrap">
          <svg id="mapSvg" viewBox="0 0 1633 1137" role="img" aria-labelledby="map-title" aria-describedby="map-desc">
            <title id="map-title">Rzeczpospolita Obojga Narodów ok. 1650 r. – uproszczony podział</title>
            <desc id="map-desc">Uproszczona, poglądowa mapa z pięcioma regionami: Prusy, Wielkopolska, Małopolska, Litwa, Ukraina. Granice i kształty są przybliżone, służą wyłącznie interakcji i rysowaniu.</desc>

            <!-- Definicje -->
            <defs>
              <marker id="arrow" viewBox="0 0 10 10" refX="8.5" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
                <path d="M 0 0 L 10 5 L 0 10 z" fill="#eab308"/>
              </marker>
              <filter id="softGlow">
                <feGaussianBlur stdDeviation="2.2" result="blur"/>
                <feMerge>
                  <feMergeNode in="blur"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
            </defs>

            <!-- REGIONY -->
            <path id="r-prusy" class="region" tabindex="0" data-key="prusy" fill="#38bdf8" d="M 329 512.1875 L 386 464.1875 L 403 471.1875 L 400 491.1875 L 416 493.1875 L 422 485.1875 L 446 494.1875 L 469 486.1875 L 524 481.1875 L 548 456.1875 L 566 441.1875 L 569 407.1875 L 576 392.1875 L 576 381.1875 L 587 373.1875 L 565 344.1875 L 569 321.1875 L 548 303.1875 L 531 305.1875 L 531 297.1875 L 514 292.1875 L 508 267.1875 L 499 261.1875 L 497 276.1875 L 504 298.1875 L 511 300.1875 L 511 308.1875 L 501 314.1875 L 497 342.1875 L 488 338.1875 L 488 347.1875 L 467 337.1875 L 461 340.1875 L 463 330.1875 L 452 335.1875 L 415 337.1875 L 417 357.1875 L 439 363.1875 L 410 388.1875 L 391 392.1875 L 364 394.1875 L 346 391.1875 L 333 382.1875 L 310 376.1875 L 316 359.1875 L 340 372.1875 L 335 359.1875 L 320 350.1875 L 308 362.1875 L 302 351.1875 L 298 386.1875 L 276 400.1875 L 262 417.1875 L 259 427.1875 L 241 422.1875 L 217 425.1875 L 220 448.1875 L 207 466.1875 L 224 482.1875 L 238 494.1875 L 266 485.1875 L 300 502.1875 L 329 512.1875 Z"/>
            <path id="r-wielkopolska" class="region" tabindex="0" data-key="wielkopolska" fill="#60a5fa" d="M 189 463.1875 L 206 472.1875 L 240 497.1875 L 263 486.1875 L 276 498.1875 L 323 511.1875 L 362 486.1875 L 384 465.1875 L 402 472.1875 L 400 489.1875 L 412 496.1875 L 423 485.1875 L 452 494.1875 L 469 484.1875 L 519 482.1875 L 540 457.1875 L 568 443.1875 L 569 421.1875 L 595 430.1875 L 618 491.1875 L 647 516.1875 L 626 547.1875 L 596 560.1875 L 588 597.1875 L 565 605.1875 L 557 628.1875 L 520 597.1875 L 487 624.1875 L 433 633.1875 L 403 634.1875 L 357 646.1875 L 326 678.1875 L 260 709.1875 L 245 695.1875 L 243 674.1875 L 207 640.1875 L 198 631.1875 L 194 613.1875 L 167 624.1875 L 122 615.1875 L 120 584.1875 L 89 559.1875 L 94 545.1875 L 154 523.1875 L 172 517.1875 L 173 504.1875 L 177 473.1875 L 189 463.1875 Z"/>
            <path id="r-malopolska" class="region" tabindex="0" data-key="malopolska" fill="#a78bfa" d="M 360 645.1875 L 399 635.1875 L 427 641.1875 L 466 628.1875 L 480 631.1875 L 512 599.1875 L 550 624.1875 L 566 644.1875 L 594 644.1875 L 608 651.1875 L 648 638.1875 L 665 650.1875 L 643 675.1875 L 656 702.1875 L 619 732.1875 L 615 757.1875 L 659 751.1875 L 694 772.1875 L 700 799.1875 L 727 789.1875 L 769 797.1875 L 803 818.1875 L 865 797.1875 L 871 807.1875 L 883 808.1875 L 867 826.1875 L 869 861.1875 L 866 890.1875 L 840 917.1875 L 821 899.1875 L 783 911.1875 L 765 909.1875 L 764 898.1875 L 690 892.1875 L 691 908.1875 L 679 930.1875 L 665 936.1875 L 660 968.1875 L 630 965.1875 L 593 948.1875 L 520 896.1875 L 494 899.1875 L 474 886.1875 L 437 871.1875 L 422 854.1875 L 379 854.1875 L 346 870.1875 L 303 850.1875 L 280 844.1875 L 277 825.1875 L 276 810.1875 L 269 794.1875 L 273 776.1875 L 266 760.1875 L 276 739.1875 L 263 721.1875 L 256 707.1875 L 286 696.1875 L 314 683.1875 L 337 669.1875 L 358 645.1875 Z"/>
            <path id="r-litwa" class="region" tabindex="0" data-key="litwa" fill="#34d399" d="M 570 413.1875 L 574 393.1875 L 575 381.1875 L 589 376.1875 L 566 346.1875 L 569 328.1875 L 542 303.1875 L 532 302.1875 L 531 297.1875 L 521 294.1875 L 514 291.1875 L 510 263.1875 L 495 263.1875 L 498 243.1875 L 490 220.1875 L 518 216.1875 L 525 220.1875 L 535 211.1875 L 548 211.1875 L 569 203.1875 L 574 208.1875 L 594 198.1875 L 621 210.1875 L 627 222.1875 L 652 204.1875 L 680 216.1875 L 702 209.1875 L 709 217.1875 L 738 214.1875 L 754 233.1875 L 771 244.1875 L 831 236.1875 L 845 221.1875 L 887 219.1875 L 901 229.1875 L 931 207.1875 L 949 205.1875 L 974 200.1875 L 985 208.1875 L 1014 204.1875 L 1044 218.1875 L 1070 219.1875 L 1101 206.1875 L 1121 250.1875 L 1123 284.1875 L 1137 304.1875 L 1134 322.1875 L 1139 357.1875 L 1136 376.1875 L 1178 425.1875 L 1179 456.1875 L 1190 488.1875 L 1183 514.1875 L 1162 529.1875 L 1177 565.1875 L 1163 584.1875 L 1142 600.1875 L 1123 591.1875 L 1103 595.1875 L 1080 603.1875 L 1033 615.1875 L 942 631.1875 L 922 628.1875 L 895 653.1875 L 844 640.1875 L 822 637.1875 L 822 631.1875 L 790 653.1875 L 783 661.1875 L 734 653.1875 L 728 643.1875 L 695 654.1875 L 663 656.1875 L 663 642.1875 L 644 637.1875 L 611 646.1875 L 591 642.1875 L 566 646.1875 L 557 634.1875 L 562 604.1875 L 588 598.1875 L 595 563.1875 L 625 553.1875 L 629 538.1875 L 651 523.1875 L 615 491.1875 L 594 429.1875 L 570 415.1875 Z"/>
            <path id="r-ukraina" class="region" tabindex="0" data-key="ukraina" fill="#f472b6" d="M 661 657.1875 L 680 657.1875 L 704 648.1875 L 717 642.1875 L 734 650.1875 L 783 662.1875 L 791 653.1875 L 820 633.1875 L 839 640.1875 L 892 651.1875 L 920 630.1875 L 954 631.1875 L 1072 602.1875 L 1088 604.1875 L 1128 585.1875 L 1150 613.1875 L 1141 646.1875 L 1179 649.1875 L 1221 652.1875 L 1249 648.1875 L 1267 671.1875 L 1290 674.1875 L 1301 689.1875 L 1303 713.1875 L 1303 731.1875 L 1289 745.1875 L 1332 759.1875 L 1344 794.1875 L 1338 829.1875 L 1360 850.1875 L 1340 897.1875 L 1269 917.1875 L 1251 956.1875 L 1236 981.1875 L 1154 992.1875 L 1123 983.1875 L 1107 981.1875 L 1086 985.1875 L 1048 997.1875 L 1008 988.1875 L 977 959.1875 L 941 956.1875 L 886 965.1875 L 853 979.1875 L 847 953.1875 L 842 912.1875 L 870 881.1875 L 874 863.1875 L 870 854.1875 L 866 825.1875 L 882 809.1875 L 870 807.1875 L 869 798.1875 L 806 815.1875 L 764 793.1875 L 723 783.1875 L 706 799.1875 L 696 783.1875 L 693 763.1875 L 668 746.1875 L 624 758.1875 L 613 755.1875 L 613 734.1875 L 659 705.1875 L 638 675.1875 L 660 657.1875 Z"/>

            <!-- warstwa boxów + fortów -->
            <g id="boxLayer"></g>
            <!-- warstwa armii (nad boxami) -->
            <g id="armiesLayer"></g>
            <g id="enemiesLayer"></g>
            <!-- warstwa rysunków -->
            <g id="overlay"></g>
          </svg>

          <div class="coords" id="coords">x: –, y: –</div>
        </div>
      </section>

      <aside class="rightbar" id="rightBar" aria-label="Szybkie akcje">
        <div class="head">
          <h2>Akcje fazy</h2>
        </div>
        <div class="section">
          <div style="color:#94a3b8;font-size:.9rem">Wybrana prowincja:</div>
          <div id="pickedRegion">–</div>
        </div>
        <div class="section">
          <h3 style="margin:0 0 8px;font-size:1rem;color:#cbd5e1">Przyciski</h3>
          <div id="phaseActions" role="group" aria-label="Przyciski fazy"></div>
        </div>
      </aside>

      <!-- KONSOLA -->
      <section class="console" aria-label="Konsola poleceń">
        <div class="bar">
          <span class="title">Konsola</span>
          <button id="btnHelp" type="button">Pomoc</button>
          <button id="btnClearLog" type="button">Wyczyść log</button>
          <span class="hint">Enter = wykonaj • Strzałki ↑/↓ = historia</span>
        </div>
        <div class="log" id="log" aria-live="polite" aria-atomic="false"></div>
        <form id="cmdForm" autocomplete="off">
          <input id="cmdInput" type="text" inputmode="text" spellcheck="false" placeholder='np. "wealth litwa 3", "wealthall 1", "armia litwa 2 #34d399 7", "armset prusy 1 12", "armclr malopolska 3", "armreset ukraina", "pomoc"'>
          <button type="submit">Wykonaj</button>
        </form>
      </section>
    </div>
  </main>

  <!-- [DODAJ] Popup (modal) -->
<div id="popupBackdrop" class="popup-backdrop" hidden>
  <div class="popup" role="dialog" aria-modal="true" aria-labelledby="popupTitle">
    <div class="popup-content">
      <h3 id="popupTitle" class="popup-title"></h3>
      <div class="popup-image-wrap">
        <img id="popupImage" alt="" hidden />
      </div>
      <div id="popupText" class="popup-text"></div>
      <div class="popup-actions">
        <button id="popupOkBtn" type="button" class="popup-btn">Zamknij</button>
      </div>
    </div>
    </div>
  </div>
</div>

  <script type="module" src="app.js"></script>
</body>
</html>

